# Генератор артефактов потоков RDV на основе маппинга

## Описание
Генератор на Python формирует на основе файла маппинга артефакты потоков RDV 
(yaml файлы метаданных, py файл WF, json-ресурсов ЦЕХ) на основании 
установленных разработчиком параметров (системы источника DAPP или 
DRP и режима захвата данных) в соответствии с их расположением в 
директориях для работы фреймворка на стендах и для формирования 
поставки в Bitbucket. Потоки формируются для проведения загрузки 
1к1 (1 источник грузит в 1 приёмник).

## Установка
Для работы с генератором требуется **Python 3.10+** версии (иначе скрипт 
будет падать с ошибкой). Далее нужно сделать следующее:

1. Склонировать к себе репозиторий
2. Открыть терминал и создать в папке виртуальное окружение
```bash
py -m venv venv 
# или 
python -m venv venv
```
3. Перейти в режим виртуального окружения при помощи запуска скрипта (важно, чтобы запуск скрипта был именно через **cmd**, на не через PowerShell). Если в начале командной строки появилась надпись **(venv)**, то переход в виртуальное оркужение произошёл успешно.
```bash
.\venv\Scripts\activate.bat
```
4. Установить необходимые зависимотси для виртуального окружения с помощью команды
```bash
py -m pip install -r requirements.txt 
# или
python -m pip install -r requirements.txt
```
5. Для проверки запуска программы необходимо выполнить команду и должно появиться окно программы
```bash
py main.py --ui
```

Если все пункты выполнены успешно - **вы великолепны :)**

## Использование генератора

Генератор может работать как через командную строку посредством задания
параметров запуска скрипта, так и через графический интерфейс. Для
запуска генератора используется файл main.py со следующими параметрами:

**--ui** - Включение генератора через графический интерфейс. При испольщовании данного параметра откроется окно программы.

**--src_cd <код_источника>** - Придуманных код источника, который используется для того, чтобы создать уникальную папку с этим кодом источника (зависимости от СУБО и выбранного кода нет, просто выберите тот, с помощью которого можно будет найти результат работы генератора на текущем запуске)

**--path <полный_путь_к_файлу>** - Указывается полный путь к файлу маппинга, который необходимо обработать. ДЛя передачи его в качестве аргумента командной строки рекомендуется использовать двойные кавычки.

**--load <режим_загрузки>** - Выбор режима загрузки, который будет осуществляться при работе потока (increment или snapshot).

**--sys <система>** - Выбор системы источника для потока. В данном случае необходимо указать, что является источником данных для данного потока (DAPP или DRP, указывать заглавными буквами).

____________________

### !!! Важно !!!
При выборе системы источника стоит учитывать именно первоисточник загрузки
данных. То есть, елси изначально СУБО грузилось в DRP, а в DAPP было перенесено
только в ра мках миграции, то в качествке параметра генератора
стоит указывать всё равно DRP.

____________________


Типичный пример запуска генератора через скрипт:
```bash
py main.py --src_cd 1785 --path "C:\Users\user\Documents\Mapping_file_BOOP.xlsx" --load increment --sys DAPP
```

Запуск генератора через графический интерфейс:
```bash
py main.py --ui
```